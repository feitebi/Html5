<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <title>飞特币－钱包</title>
  <meta name="description" content="社交化加密币投顾平台" />
  <meta name="keywords" content="比特币, 飞特币, 飞特币, 以太坊, 虚拟币, 加密币，量子链, 区块链, 钱包, 跨链" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- for ios 7 style, multi-resolution icon of 152x152 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-barstyle" content="black-translucent">
  <link rel="apple-touch-icon" href="../assets/images/logo.png">
  <meta name="apple-mobile-web-app-title" content="Feitebi">
  <!-- for Chrome on Android, multi-resolution icon of 196x196 -->
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" sizes="196x196" href="../assets/images/logo.png">
  
  <!-- style -->
  <link rel="stylesheet" href="../assets/animate.css/animate.min.css" type="text/css" />
  <link rel="stylesheet" href="../assets/glyphicons/glyphicons.css" type="text/css" />
  <link rel="stylesheet" href="../assets/font-awesome/css/font-awesome.min.css" type="text/css" />
  <link rel="stylesheet" href="../assets/material-design-icons/material-design-icons.css" type="text/css" />

  <link rel="stylesheet" href="../assets/bootstrap/dist/css/bootstrap.min.css" type="text/css" />
  <!-- build:css ../assets/styles/app.min.css -->
  <link rel="stylesheet" href="../assets/styles/app.css" type="text/css" />
  <!-- endbuild -->
  <link rel="stylesheet" href="../assets/styles/font.css" type="text/css" />
  <style>
    span.logo{font-size: 16px;font-weight: 400}.paddingTop10{padding-top: 8px}.navbar-brand{font-weight: 200}
    .wh120{width: 120px;height: 120px}.wh64{width: 64px;height: 64px} @media (min-width: 769px) {.push-left-160 {padding-left:160px !important; } }

    .styleHeight{
      width: 45%;
      height: 100%;
    }
    .fontSize{
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
<div class="app" id="app">
    
<!-- ############ LAYOUT START-->

  <!-- aside -->
  <div id="aside" class="app-aside modal fade nav-dropdown">
    <!-- fluid app aside -->
    <div class="left navside dark dk" layout="column">
      <div class="navbar no-radius">
        <!-- brand -->
        <a class="navbar-brand">
            <img src='./images/logo-c.png'/> 飞特币
        </a>
        <!-- / brand -->
      </div>
      <div flex class="hide-scroll">
          <nav class="scroll nav-light">
             <ul class="nav listLi" ui-nav>
                <li>
                  <a href="wallet.html" >
                    <span class="nav-icon">
                      <i class="material-icons">&#xe850;
                        <span ui-include="'../assets/images/i_0.svg'"></span>
                      </i>
                    </span>
                    <span class="nav-text">代币</span>
                  </a>
                </li>
                <li>
                  <a href="index.html" >
                    <span class="nav-icon">
                      <i class="material-icons">&#xe7fc;
                        <span ui-include="'../assets/images/i_3.svg'"></span>
                      </i>
                    </span>
                    <span class="nav-text">钱包</span>
                  </a>
                </li>
                <li>
                  <a href="send.html" >
                    <span class="nav-icon">
                      <i class="material-icons">&#xe2c6;
                        <span ui-include="'../assets/images/i_3.svg'"></span>
                      </i>
                    </span>
                    <span class="nav-text">发送</span>
                  </a>
                </li>
                <li>
                  <a href="settings.html" >
                    <span class="nav-icon">
                      <i class="material-icons">&#xe8b9;
                        <span ui-include="'../assets/images/i_3.svg'"></span>
                      </i>
                    </span>
                    <span class="nav-text">设置</span>
                  </a>
                </li>
              </ul>
          </nav>
      </div>
      
       <div flex-no-shrink>
        <nav ui-nav>
            <ul class="nav">
              <li><div class="b-b b m-t-sm"></div></li>
              <li class="no-bg">
                <a href="javascript:void()" onclick="logout()">
                  <span class="nav-icon">
                   <i class="material-icons">&#xe8ac;</i>
                  </span>
                  <span class="nav-text">退出</span>
                </a>
              </li>
            </ul>
          </nav>
      </div>
    </div>
  </div>
  <!-- / -->
  
  <!-- content -->
  <div id="content" class="app-content box-shadow-z0" role="main">
    <div class="app-header blue-700">
        <div class="navbar">
            <!-- Open side - Naviation on mobile -->
            <a data-toggle="modal" data-target="#aside" class="navbar-item pull-left hidden-lg-up">
              <i class="material-icons">&#xe5d2;</i>
            </a>
            <!-- / -->
        
            <!-- Page title - Bind to $state's title -->
            <a class="navbar-item pull-right hidden-lg-up" href='settings.html'>
              <i class="material-icons">&#xe8b8;</i>
            </a>
           <div class="navbar-item text-center h5" ng-bind="$state.current.data.title" id="pageTitle">提币</div>
        </div>
    </div>
    <div class='app-footer'>
      <nav class="navbar white navbar-fixed-bottom" style='height: 70px'>
        <div class="push-left-160">
          <div class="row text-center p-t-sm text-md">
              <div class="col-md-4 col-xs-4"><a href='wallet.html'><i class="material-icons text-lg">&#xe84f;</i><br/>代币</a></div>
              <div class="col-md-4 col-xs-4"><a href='index.html'><i class="material-icons text-lg">&#xe7fc;</i><br/>钱包</a></div>
              <div class="col-md-4 col-xs-4 text-info"><a href='send.html'><i class="material-icons text-lg">&#xe2c6;</i><br/>发送</a></div>
          </div>
        </div>
      </nav>
    </div>
    <div ui-view class="app-body" id="view">
        <div class="padding p-b-lg p-t-lg">
                <div class="p-b-md p-t-md row">
                  <div class="col-md-3 col-md-offset-5">
                      <span class="fontSize">手机号验证</span>
                      <input type='text' class="fontSize md-input text-sm styleHeight" id='showPhone' readonly="readonly">
                  </div>
                </div>
                <div class="p-b-md p-t-md row">
                  <div class="col-md-3 col-md-offset-5">
                      <input type='number' class="fontSize md-input text-sm focusObj styleHeight" id='toAddress2' placeholder='请输入验证码'>
                      <button type="button" id='sendPhone' class="btn blue-700">发送</button>
                  </div>
                </div>
                
              <div class="p-b-md p-t-md row">
                  <div class="col-md-2 col-md-offset-5">
                      <button type="button" id='sendOk' class="btn btn-gray btn-block rounded" disabled="true">OK</button>
                  </div>

                  <!-- 模态框 -->
                      <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div class="modal-header">
                              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                &times;
                              </button>
                              <h4 class="modal-title text-center" id="myModalLabel">
                                验证码输入错误
                              </h4>
                            </div>
                              
                          </div><!-- /.modal-content -->
                        </div><!-- /.modal -->
                      </div>
              </div>
        </div>
    </div>
  </div>
  <!-- / -->

<!-- ############ LAYOUT END-->

<!-- .modal -->

<!-- / .modal -->



</div>

<!-- build:js scripts/app.html.js -->
<!-- jQuery -->
  <script src="../libs/jquery/jquery/dist/jquery.js"></script>
<!-- Bootstrap -->
  <script src="../libs/jquery/tether/dist/js/tether.min.js"></script>
  <script src="../libs/jquery/bootstrap/dist/js/bootstrap.js"></script>
  <script src="scripts/common.js?v=1.0.0.2892"></script>
  <script type="text/javascript">
   

   $(document).ready(function() {
     if(!isLogin()){
          var ref = getUrlParameter('ref');
          if (typeof ref == 'undefined' || ref == null) {
            ref ="";
          }
          /**window.location.href='signin.html?ref='+ref;**/
     }else {
       /** if(!isRealNameValid()){
          $('#sendAssetBtn').attr('disabled',"true");

          $("#dlgTips").text("请先做实名认证！");
          $("#tipsDlg").modal('show');

          setTimeout(function() {
            window.location.href='nameValid.html';
          }, 2000);
       }else{
           var balance = getStorageJson(WALLET_BALANCE_TAG);
           if(balance){
              $('#balanceQty').html(balance);
           }
           getAddrMinerFeeBalance();
        } */
        // getAddrMinerFeeBalance();
     }

      //导入手机号
      var USER_TAG = "USER_DATA";
      var user = getStorageJson(USER_TAG);
      $('#showPhone').val(user.phone)//user.phone

      

      //发送按钮
      $('#sendPhone').click(function(){
          //倒计时读秒
          var count = 59;
          var _this = this;
          var tim = setInterval(function(){
            if (count==0) {
              $(_this).html('发送');
              clearInterval(tim)
              return;
            }
            $(_this).html(count);
            count--;
          },1000)
          
          //验证码输入框
            var focusObj = document.querySelector('.focusObj');
            focusObj.onfocus = function(){
                clearInterval(tim);
                $(_this).html('发送');
            }

            focusObj.oninput = function(){
              if (focusObj.value.length==6) {
                //console.log(document.getElementById('sendOk').disabled)
                //删除禁用属性
                document.getElementById('sendOk').removeAttribute('disabled'); 
                //替换按钮 背景颜色
                document.getElementById('sendOk').classList.remove('btn-gray');
                document.getElementById('sendOk').classList.add('blue-700');
              }
            }


            //验证码随机数
              //设置一个全局的变量，便于保存验证码
            var codeNumber = "";
            
            //设置长度，这里看需求，我这里设置了6
            var codeLength = 6;
            
            //设置随机字符
            var random = new Array(1,2,3,4,5,6,7,8,9);
            // console.log(random.length) 10

            //循环codeLength 我设置的6就是循环6次
            for(var i = 0; i < codeLength; i++){
                //设置随机数范围,这设置为0 ~ 10
                var index = Math.floor(Math.random()*random.length);

                //字符串拼接 将每次随机的字符 进行拼接
                codeNumber += random[index]; 
            }
            //console.log(codeNumber)

            $.ajax({
               type: "POST",
               url: "http://dingxin.market.alicloudapi.com/dx/sendSms",
               headers:{'Authorization':'APPCODE 6e58e27f2c7949e8a79ef2ef39c8097c'},
               data: {
                mobile:user.phone, //电话号码
                param:'code:'+codeNumber,
                tpl_id:"TP1804033"
              },
              success: function(msg){
                 console.log(msg);
               }
            });
            

            //ok确认

            $('#sendOk').click(function(){
              console.log(focusObj.value)
                  if (focusObj.value == codeNumber) {

                    console.log('证码成功');
                    // var dom = document.getElementById('sendOk');
                    // dom.setAttribute('data-toggle','modal');
                    // dom.setAttribute('data-target','#myModal');
                    window.location.href = 'ethConfig.html'
                  }else{
                    // 添加bootstrap模态框插件 属性
                    console.log('证码失败');
                    var dom = document.getElementById('sendOk');
                    dom.setAttribute('data-toggle','modal');
                    dom.setAttribute('data-target','#myModal');
                  }

            })






      })

      var balance = getStorageJson(WALLET_BALANCE_TAG);
      if(balance){
        $('#balanceQty').html(balance);
      }

   })

   $(".md-input").bind("propertychange input",function(){
      var balance = getStorageJson(WALLET_BALANCE_TAG);
      var myAddr = getStorageJson(WALLET_ADDR_TAG);
      var toAddr = $('#toAddress').val();
      var sendAmount = $('#sendAmount').val();

      var minerFee = $('#minerFeeBalance').text();

      if(myAddr!=toAddr && toAddr.length==34 && parseFloat(sendAmount)>0 
        && parseFloat(sendAmount)<=parseFloat(balance) && parseInt(minerFee)>0){
          $('#sendAssetBtn').addClass('info');
          $('#sendAssetBtn').removeAttr("disabled");
      } else {
          $('#sendAssetBtn').attr('disabled',"true");
          $('#sendAssetBtn').removeClass('info');
      }

   });
  </script>
  
</body>
</html>
